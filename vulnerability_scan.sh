#!/bin/bash

# Update package lists
apt-get update

# Install necessary dependencies
apt-get install -y \
    ca-certificates \
    golang

# Install CA certificates
update-ca-certificates

# Install nuclei
GO111MODULE=on go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest

# Run nuclei to scan for vulnerabilities
~/go/bin/nuclei -target localhost -t cves/

# Create a report and store it as a file
~/go/bin/nuclei -target localhost -t cves/ -json-export /output/nuclei_vulnerabilities_report.json

# Uninstall nuclei
GO111MODULE=on go clean -i github.com/projectdiscovery/nuclei/v3/cmd/nuclei

# Clean up unused dependencies
apt-get autoremove -y golang
